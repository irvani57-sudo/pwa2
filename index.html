<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>alfrdo-Omidpay</title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#1976d2">

  <link rel="manifest" href="manifest.json">

  <style>
    html, body {
      margin: 0;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: sans-serif;
      background: #ffffff;
      text-align: center;
      color: #333;
    }
  </style>
</head>

<body>
  <div>
    <h1>alfrdo-Omidpay</h1>
    <p>â³ Ø¯Ø± Ø­Ø§Ù„ ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø§Ù¾...</p>
  </div>

  <script>
    // âœ… Ø«Ø¨Øª Service Worker ÙÙ‚Ø· ÛŒÚ©â€ŒØ¨Ø§Ø±
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js')
        .then(() => console.log('Service Worker Ø«Ø¨Øª Ø´Ø¯'))
        .catch(err => console.error('SW error:', err));
    }

    // âœ… ØªØ´Ø®ÛŒØµ Ø¯Ù‚ÛŒÙ‚ Ø­Ø§Ù„Øª standalone
    function isStandalone() {
      return (
        window.matchMedia('(display-mode: standalone)').matches ||
        window.navigator.standalone === true
      );
    }

    let redirected = false;
    function tryRedirect() {
      if (redirected) return;
      if (isStandalone()) {
        redirected = true;
        console.log("ğŸ“± Ø­Ø§Ù„Øª Ù†ØµØ¨â€ŒØ´Ø¯Ù‡ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ø¯ â†’ Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ");
        window.location.replace("https://script.google.com/macros/s/AKfycbwR_6ldbYI3JXCrjPcy7VHqk66150JyIib4lwfO-ktdgZC8vq3rDOfV7brgaQwU8e2yYA/exec");
      }
    }

    // ğŸ” Ú†Ù†Ø¯ Ø¨Ø§Ø± Ø§Ù…ØªØ­Ø§Ù† Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² ØªØ´Ø®ÛŒØµ Ø¯Ø±Ø³Øª
    tryRedirect();
    setTimeout(tryRedirect, 700);
    setTimeout(tryRedirect, 1500);
    setTimeout(tryRedirect, 3000);
    document.addEventListener('visibilitychange', tryRedirect);

    // âœ… Ù†Ù…Ø§ÛŒØ´ Ø¯Ú©Ù…Ù‡ Ù†ØµØ¨ Ø¯Ø± Ø­Ø§Ù„Øª Ù…Ø±ÙˆØ±Ú¯Ø±
    window.addEventListener('beforeinstallprompt', (event) => {
      event.preventDefault();
      const installButton = document.createElement("button");
      installButton.innerText = "ğŸ“² Ù†ØµØ¨ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù†";
      installButton.style.cssText = "background:#1976d2;color:white;padding:10px 20px;border:none;border-radius:6px;cursor:pointer;font-size:16px;margin-top:15px;";
      document.body.appendChild(installButton);

      installButton.addEventListener("click", () => {
        event.prompt();
        event.userChoice.then(choice => {
          if (choice.outcome === "accepted") {
            console.log("âœ… Ø§Ù¾ Ù†ØµØ¨ Ø´Ø¯!");
            installButton.remove();
          } else {
            console.log("âŒ Ù†ØµØ¨ Ú©Ù†Ø³Ù„ Ø´Ø¯!");
          }
        });
      });
    });
  </script>
</body>
</html>
